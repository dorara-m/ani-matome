!function(){"use strict";const e=()=>{const e=localStorage.getItem("readIds");return e?JSON.parse(e):[]},t=(e,t)=>e.length<=t?e:e.substring(0,t)+"â€¦",n=e=>{const t=new Date(e);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`},s=e=>{const t=e.place,n=document.getElementById("js-note-head"),s=document.getElementById("js-note-chat");if(!n||!s)return;const a=e.chats;let l="",c=[];a.forEach((e=>{var t;c.push(e.who.id),l+=`<li>\n    <div class="icon">\n    <img src="${e.who.icon.url}", alt="${e.who.nameJp}">\n    </div>\n    <div class="left">\n      <div class="name">${e.who.nameJp}</div>\n      <div class="says">${t=e.says,t.replace("\n","<br>")}</div>\n      </div>\n      </li>`,e.image&&(l+=`<li>\n        <div class="icon">\n        <img src="${e.who.icon.url}", alt="${e.who.nameJp}">\n        </div>\n        <div class="left">\n        <div class="name">${e.who.nameJp}</div>\n        <a href="${e.image.url}" target="_blank" class="saysImage">\n          <img src="${e.image.url}", alt="">\n        </a>\n      </div>\n      </li>`),e.link&&(l+=`<li>\n      <div class="icon">\n      <img src="${e.who.icon.url}", alt="${e.who.nameJp}">\n      </div>\n      <div class="left">\n      <div class="name">${e.who.nameJp}</div>\n      <a href="${e.link}" target="_blank" class="says -link">${e.link}</a>\n      </div>\n      </li>`)}));const i=c.filter(((e,t,n)=>n.indexOf(e)===t));n.innerHTML=`${t} (${i.length+1})`,s.innerHTML=l},a=t=>{const n=e(),s=document.getElementById("js-note-toggle");t.length!==n.length?s?.classList.add("-js-unRead"):s?.classList.remove("-js-unRead")};(async()=>{try{const l=await fetch("https://uma-chat.microcms.io/api/v1/chat?limit=99",{headers:{"X-MICROCMS-API-KEY":"eb94b33042b64da7badbbba4642b22db81a3"}}).then((e=>{if(!e.ok)throw new Error("Network response was not OK");return e.json()})).then((e=>e.contents)).catch((e=>{throw new Error(e)}));(()=>{const e=document.getElementById("js-note-wrap"),t=document.getElementById("js-note-toggle");t&&e&&t.addEventListener("click",(()=>{e.classList.toggle("-js-active")}))})(),a(l),(s=>{const a=e(),l=document.getElementById("js-note-listContent");if(!l)return;const c=s;let i="<ul>";for(let e=0;e<c.length;e++)i+=`<li class="js-note-item">\n    <div class="icon">\n    <img src="${c[e].chats[0].who.icon.url}" alt="" />\n    </div>\n    <div class="text">\n    <div class="head">${n(c[e].date)}</div>\n    <p>${t((o=c[e].chats[0].says,-1==o.indexOf("\n")?o:o.replace("\n","")),13)}</p>\n    </div>\n    <div class="count js-count ${a.includes(c[e].id)?"":"unRead"}">${c[e].chats.length}</div>\n    </li>`;var o;i+="</ul>",l.innerHTML=i})(l),(t=>{const n=document.getElementById("js-note-list"),l=document.getElementById("js-note-page"),c=document.getElementById("js-note-back"),i=document.getElementsByClassName("js-note-item");if(n&&l&&c){for(let c=0;c<i.length;c++)i[c].addEventListener("click",(()=>{const i=e();n.classList.add("slideOut"),l.classList.add("slideIn"),l.scrollTo(0,0),s(t[c]),i.includes(t[c].id)||(i.push(t[c].id),document.getElementsByClassName("js-count")[c].classList.remove("unRead"),localStorage.setItem("readIds",JSON.stringify(i)),a(t))}));c.addEventListener("click",(function(){n.classList.remove("slideOut"),l.classList.remove("slideIn")}))}})(l)}catch(e){console.error(e)}})(),(()=>{const e=document.getElementById("js-reload");e&&e.addEventListener("click",(()=>{location.reload()}))})(),(()=>{const e=document.getElementById("js-modal-on"),t=document.getElementById("js-modal-body");if(!e||!t)return;e.addEventListener("click",(()=>{t.classList.add("active")}));const n=document.getElementById("js-modal-off");n?.addEventListener("click",(()=>{t.classList.remove("active")}))})()}();